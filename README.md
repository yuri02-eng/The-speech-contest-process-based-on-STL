# 基于STL的演讲比赛流程

本项目使用 C++（C++17）和 STL（标准模板库）实现了一个控制台模拟的两轮演讲比赛管理程序。通过常用容器与算法展示比赛流程的实现细节，包括选手创建、随机抽签、评委打分、去掉最高最低分求平均、分组晋级、保存与读取比赛记录等。

---

## 项目亮点

- 以教学演示为目标，完整实现比赛流程与评分规则。
- 使用 STL 容器与算法：`vector`、`deque`、`map`、`multimap`、`shuffle`、`sort`、`accumulate` 等。
- 随机数由 `std::random_device` + `std::mt19937` 与 `std::uniform_real_distribution` 生成实数分数（60.0–100.0）。
- 结果以简单 CSV 格式追加保存，程序支持读取并显示历史记录。

---

## 功能清单

- 自动创建选手（默认 12 人，编号从 `10001` 开始）。
- 模拟两轮比赛：初赛（第一轮）与复赛（第二轮）。
- 每位选手由 10 个随机分数模拟评委评分，去掉最高与最低，取剩余 8 个分数的平均值作为本轮成绩。
- 每组 6 人，按成绩降序选出前 3 人晋级。
- 比赛结束后将最终晋级者编号与复赛分数追加写入 `speech.csv`。
- 支持从 `speech.csv` 读取并打印历史记录（文件不存在/为空时有提示）。

---

## 文件说明

- `演讲比赛流程管理系统.cpp`（或 `main.cpp`）：程序入口，显示菜单并调用 `SpeechManager` 执行流程。
- `speechManager.h` / `speechManager.cpp`：核心管理类 `SpeechManager`，负责选手创建、抽签、比赛逻辑、成绩展示、记录保存/加载等。
- `speaker.h` / `speaker.cpp`：数据结构 `Speaker`，包含选手姓名、编号和每轮成绩数组 `m_Score`。
- `speech.csv`：运行时生成或追加的记录文件，位于运行目录。
- `README.md`：项目说明文档（当前文件）。

---

## 编译与运行

建议使用支持 C++17 的编译器。

Windows（Visual Studio）：
- 使用 Visual Studio 新建控制台项目，把源码文件添加到项目后直接编译运行。

Linux / macOS（g++ 示例）：
- 在项目目录执行：

  g++ -std=c++17 演讲比赛流程管理系统.cpp speechManager.cpp speaker.cpp -o SpeechContest

- 运行：

  ./SpeechContest

---

## 运行时菜单（示例）

程序启动后，会在控制台显示类似菜单：

1. 开始演讲比赛
2. 查看往届记录
3. 清空比赛记录
0. 退出比赛程序

- 选择 1：开始两轮比赛，显示过程并在结束后将结果追加保存到 `speech.csv`。
- 选择 2：读取并打印 `speech.csv` 内容（按空白分割读取的实现会将逗号分隔的字段分开显示，详见注意事项）。
- 选择 3：清空记录（需实现或手动删除 `speech.csv`）。
- 选择 0：退出程序。

---

## `speech.csv` 文件格式说明

当前实现以追加的方式写入：将最终晋级者的编号与第二轮分数按顺序写入文件，用逗号分隔（例如：`10002,87.35,10005,91.12,10001,89.45,`），然后换行。每次比赛会在文件中追加一行。注意：目前每位选手并没有单独换行，字段层级较简单，若需兼容更严格的 CSV 工具，建议改写保存逻辑为每位选手一行并在首行添加表头。

---

## 设计细节（实现要点）

- 选手存储：使用 `map<int, Speaker>` 按编号索引选手对象，方便随机抽签后的直接访问与更新分数。
- 抽签：将选手编号存入 `vector`，通过 `std::shuffle` 打乱顺序来模拟抽签。
- 打分：对每位选手生成 10 个随机分数，使用 `deque<double>` 保存，排序后 `pop_front()` 和 `pop_back()` 删除最高与最低，然后 `std::accumulate` 计算和并除以容器大小获得均分。
- 晋级：使用 `multimap<double,int,greater<double>>` 将分数作为键、选手编号作为值，按分数降序自然排序，便于取前 N。

---

## 常见问题与建议

- 读取 `speech.csv` 时当前实现使用 `ifstream >> data`（按空白分割）。因此包含逗号的行会被当作单个 token 输出，查看时阅读体验受限。若需逐字段解析，请使用 `std::getline` 按行读取并用 `std::stringstream` 或自定义解析器拆分逗号。
- 若希望每次比赛都有独立且可解析的 CSV 行，请在 `SpeechManager::saveRecord()` 中把每位选手写为单独一行，或为每一届比赛写入带有表头的一组行。
- 随机数生成：当前每次为单个选手或抽签创建一个新的 `std::random_device`/`mt19937`。在高并发或可复现测试时，可考虑将随机引擎作为 `SpeechManager` 的成员并用单一种子初始化，以便复现或统一随机行为。

---

## 可扩展方向

- 支持自定义选手名单与数量（从文件加载或命令行输入）。
- 改进 `speech.csv` 的格式，添加表头（例如：`contest_id,rank,player_id,round2_score`）并以行形式存储每位选手的数据，便于 Excel 或脚本处理。
- 增加单元测试（例如使用 Google Test）验证评分规则与晋级逻辑。
- 增加日志输出或图形用户界面。

---

## 贡献

欢迎提交 issue 或 PR。请在贡献前先描述你要实现的变更或修复，并包含可复现步骤或测试代码。

---

## 许可证

本仓库示例代码可自由学习与修改。若要公开分发或商用，请在仓库中添加合适的开源许可证（例如 MIT、Apache-2.0）。